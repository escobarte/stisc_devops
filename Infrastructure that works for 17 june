–°–µ–π—á–∞—Å —É –º–µ–Ω—è –≤–æ—Ç —Ç–∞–∫–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –∏ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç. 
–¢–µ–ø–µ—Ä—å –º–Ω–µ –Ω—É–∂–Ω–æ
1. –ø–æ—Å—Ç–∞–≤–∏—å https
2. –¥–ª—è proxy –∑–∞–∫—Ä—ã—Ç—å –≤–µ—Å—å —Ç—Ä–∞—Ñ–∏–∫ –∏ —Ä–∞–∑—Ä–µ—à–∏—Ç—å —Ç–æ–ª—å–∫–æ 80/443 
3. ssh —Ç–æ–ª—å–∫–æ –¥–ª—è Departmen SAS (–∫–∞–∫ —ç—Ç–æ —É–∑–Ω–∞—Ç—å)
4. —Å–¥–µ–ª–∞—Ç—å –¢—é–Ω–∏–Ω–≥ –¥–ª—è VM ( —É–∑–Ω–∞—Ç—å –ø—Ä–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ ubuntu ) 

–û—Ç–ª–∏—á–Ω–æ! –£ —Ç–µ–±—è —É–∂–µ –æ—á–µ–Ω—å –≥—Ä–∞–º–æ—Ç–Ω–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ ‚Äî –æ—Å—Ç–∞–ª–æ—Å—å –¥–æ–≤–µ—Å—Ç–∏ –¥–æ –ø—Ä–æ–¥–∞–∫—à–Ω-—É—Ä–æ–≤–Ω—è. –†–∞–∑–ª–æ–∂—É –≤—Å—ë –ø–æ –ø—É–Ω–∫—Ç–∞–º:

---

## ‚úÖ –ó–ê–î–ê–ß–ê 1: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å **HTTPS** –Ω–∞ VIP (`93.2`)

### üîß –í–∞—Ä–∏–∞–Ω—Ç—ã:

* üîê **Self-signed cert** ‚Äî –µ—Å–ª–∏ —Ç–µ—Å—Ç–æ–≤–∞—è —Å—Ä–µ–¥–∞
* ‚úÖ **Let‚Äôs Encrypt** ‚Äî –µ—Å–ª–∏ –µ—Å—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø + DNS
* üõ° **Internal CA** ‚Äî –µ—Å–ª–∏ –µ—Å—Ç—å –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π PKI

### üîß –ß—Ç–æ –Ω—É–∂–Ω–æ:

* –ù–∞—Å—Ç—Ä–æ–∏—Ç—å `nginx` –Ω–∞ `Prx01/Prx02` —Å–ª—É—à–∞—Ç—å –ø–æ—Ä—Ç `443`
* –î–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ü–∏—é:

```nginx
server {
    listen 443 ssl;
    server_name app.lab.local;

    ssl_certificate     /etc/nginx/ssl/app.crt;
    ssl_certificate_key /etc/nginx/ssl/app.key;

    location / {
        proxy_pass http://app_backend;
        ...
    }
}
```

–ï—Å–ª–∏ –Ω—É–∂–µ–Ω **Let‚Äôs Encrypt** + –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è ‚Äî —Å–∫–∞–∂–∏, –¥–æ–±–∞–≤–ª—é `certbot` –ø–æ—à–∞–≥–æ–≤–æ.

---

## ‚úÖ –ó–ê–î–ê–ß–ê 2: –ó–∞–∫—Ä—ã—Ç—å —Ç—Ä–∞—Ñ–∏–∫ –Ω–∞ Proxy (`Prx01`, `Prx02`), –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ `80` –∏ `443`

### üîß IPTables:

```bash
sudo iptables -P INPUT DROP
sudo iptables -P FORWARD DROP
sudo iptables -P OUTPUT ACCEPT

# –†–∞–∑—Ä–µ—à–∏—Ç—å localhost
sudo iptables -A INPUT -i lo -j ACCEPT

# –†–∞–∑—Ä–µ—à–∏—Ç—å 80, 443
sudo iptables -A INPUT -p tcp -m multiport --dports 80,443 -j ACCEPT

# –†–∞–∑—Ä–µ—à–∏—Ç—å ICMP (ping)
sudo iptables -A INPUT -p icmp -j ACCEPT

# –†–∞–∑—Ä–µ—à–∏—Ç—å ESTABLISHED
sudo iptables -A INPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT

# SSH –≤—Ä–µ–º–µ–Ω–Ω–æ
sudo iptables -A INPUT -p tcp --dport 22 -s <SAS-IP-Range> -j ACCEPT
```

üíæ –°–æ—Ö—Ä–∞–Ω–∏:

```bash
sudo iptables-save > /etc/iptables/rules.v4
```

---

## ‚úÖ –ó–ê–î–ê–ß–ê 3: SSH —Ç–æ–ª—å–∫–æ –¥–ª—è **SAS Department**

–¢—É—Ç –Ω—É–∂–Ω—ã –¥–µ—Ç–∞–ª–∏:

* –ì–¥–µ —É–∑–Ω–∞—Ç—å –∫—Ç–æ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ SAS? (LDAP/Active Directory/–æ—Ç–¥–µ–ª—å–Ω—ã–π subnet?)
* –ï—Å–ª–∏ —ç—Ç–æ IP-–¥–∏–∞–ø–∞–∑–æ–Ω, –ø—Ä–∏–º–µ—Ä: `172.29.10.0/24`, —Ç–æ–≥–¥–∞:

```bash
sudo iptables -A INPUT -p tcp --dport 22 -s 172.29.10.0/24 -j ACCEPT
```

---

## ‚úÖ –ó–ê–î–ê–ß–ê 4: –¢—é–Ω–∏–Ω–≥ VM –ø–æ–¥ Ubuntu (–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è)

üì¶ **–ú–∏–Ω–∏–º—É–º**:

* –æ—Ç–∫–ª—é—á–∏—Ç—å –Ω–µ–Ω—É–∂–Ω—ã–µ —Å–ª—É–∂–±—ã (`snapd`, `apt-daily`, `cloud-init` –µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
* —É–º–µ–Ω—å—à–∏—Ç—å `swappiness`:

  ```bash
  echo "vm.swappiness=10" | sudo tee /etc/sysctl.d/99-swappiness.conf
  ```

üß† **–°–µ—Ç—å:**

* —É–≤–µ–ª–∏—á–∏—Ç—å max open files:

  ```bash
  echo "* soft nofile 65535" | sudo tee -a /etc/security/limits.conf
  echo "* hard nofile 65535" | sudo tee -a /etc/security/limits.conf
  ```

üöÄ **systemd –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**:

* `DefaultTimeoutStartSec=10s` –≤ `/etc/systemd/system.conf`

üß± **Nginx tuning**:

* `worker_processes auto;`
* `worker_connections 4096;`
* `keepalive_timeout 15;`

---

–•–æ—á–µ—à—å ‚Äî —Å–¥–µ–ª–∞—é –ø–ª–∞–Ω –Ω–∞ –∫–∞–∂–¥—ã–π –ø—É–Ω–∫—Ç —Å –∫–æ–º–∞–Ω–¥–∞–º–∏ –ø–æ —à–∞–≥–∞–º, –Ω–∞—á–∏–Ω–∞—è —Å HTTPS?
